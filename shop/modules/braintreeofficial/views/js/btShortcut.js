/*! For license information please see btShortcut.js.LICENSE */
!function(t){var e={};function a(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=11)}({11:function(t,e){var a={button:null,data:{amount:null,currency:null,mode:null,authorizationToken:null,controller:null,idProduct:null,idProductAttribute:null,quantity:null,page:null,locale:null},init:function(){var t=$("[data-braintree-button]");0!=t.length&&(this.button=t,this.initData(),this.addListeners(),this.initPaymentBtn("checkout"),this.checkAvaibility())},addListeners:function(){prestashop.on("updateCart",(function(){a.updateCartAmount()})),prestashop.on("updatedProduct",(function(t){a.initPaymentBtn("checkout"),a.updateProductAmount(t)}))},updateProductAmount:function(t){var e=$('input[name="qty"]').val(),n=t.id_product_attribute;$.ajax({url:a.data.controller,type:"POST",dataType:"JSON",data:{ajax:!0,action:"getProductAmount",quantity:e,idProductAttribute:n,idProduct:a.data.idProduct},success:function(t){"success"in t&&1==t.success&&(a.data.amount=t.amount,a.data.quantity=e),0==a.data.amount?a.button.hide():a.button.show(),0==t.available?a.button.hide():a.button.show()}})},updateCartAmount:function(){$.ajax({url:a.data.controller,type:"POST",dataType:"JSON",data:{ajax:!0,action:"getCartAmount"},success:function(t){"success"in t&&1==t.success&&(a.data.amount=t.amount),0==a.data.amount?a.button.hide():a.button.show()}})},initData:function(){"undefined"!=typeof paypal_braintree_authorization&&(this.data.authorizationToken=paypal_braintree_authorization),"undefined"!=typeof paypal_braintree_currency&&(this.data.currency=paypal_braintree_currency),"undefined"!=typeof paypal_braintree_mode&&(this.data.mode=paypal_braintree_mode),"undefined"!=typeof paypal_braintree_amount&&(this.data.amount=paypal_braintree_amount),"undefined"!=typeof paypal_braintree_contoller&&(this.data.controller=paypal_braintree_contoller),"undefined"!=typeof paypal_braintree_id_product&&(this.data.idProduct=paypal_braintree_id_product),"undefined"!=typeof paypal_braintree_id_product_attribute&&(this.data.idProductAttribute=paypal_braintree_id_product_attribute),"undefined"!=typeof paypal_braintree_quantity&&(this.data.quantity=paypal_braintree_quantity),"undefined"!=typeof paypal_braintree_page&&(this.data.page=paypal_braintree_page),"undefined"!=typeof paypal_braintree_locale&&(this.data.locale=paypal_braintree_locale)},showError:function(t){alert(t)},sendData:function(t){var e=document.createElement("form"),n=document.createElement("input"),r=document.createElement("input"),i=document.createElement("input"),o=document.createElement("input"),u=document.createElement("input");n.name="paymentData",n.value=JSON.stringify(t),r.name="page",r.value=a.data.page,i.name="idProduct",i.value=a.data.idProduct,o.name="idProductAttribute",o.value=a.data.idProductAttribute,u.name="quantity",u.value=a.data.quantity,e.method="POST",e.action=a.data.controller,e.appendChild(n),e.appendChild(r),e.appendChild(i),e.appendChild(o),e.appendChild(u),document.body.appendChild(e),e.submit()},initPaymentBtn:function(t){var e=this;null!=a.button&&braintree.client.create({authorization:this.data.authorizationToken},(function(n,r){n?console.error("Error creating client:",n):braintree.paypalCheckout.create({client:r},(function(n,r){n?e.showError(n):($("[data-braintree-button]").html(""),paypal.Button.render({env:a.data.mode,locale:a.data.locale,commit:!0,style:{tagline:!1},payment:function(){return r.createPayment({flow:t,amount:a.data.amount,currency:a.data.currency,billingAgreementDescription:"",enableShippingAddress:!0,shippingAddressEditable:!1})},onAuthorize:function(t,e){return r.tokenizePayment(t).then((function(t){a.sendData(t)}))},onError:function(t){a.showError(t)}},"[data-braintree-button]").then((function(t){})))}))}))},checkAvaibility:function(){$.ajax({url:a.data.controller,type:"POST",dataType:"JSON",data:{ajax:!0,action:"checkProductAvaibility",idProduct:a.data.idProduct,idProductAttribute:a.data.idProductAttribute,quantity:a.data.quantity},success:function(t){"success"in t&&1==t.success&&(t.available?a.button.show():a.button.hide())}})}};$(document).ready((function(){a.init()}))}});
//# sourceMappingURL=btShortcut.js.map